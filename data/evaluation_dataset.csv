question,sql_query,tables_needed,sql_query_soft_eval,answer_detailed,answer_brief,sql_detailed_answer
How many tracks are there in the database?,SELECT COUNT(*) FROM Track;,Track,SELECT COUNT(*) FROM Track;,"There are 3,503 tracks in the database.",3503,"(3503,)"
What is the total revenue from all invoices?,SELECT SUM(Total) FROM Invoice;,Invoice,SELECT SUM(Total) FROM Invoice;,"Total revenue from all invoices is approximately $2,328.60.",2328.600000000004,"(2328.600000000004,)"
What is the name of the most popular genre by number of tracks?,SELECT Name FROM Genre WHERE GenreId = (SELECT GenreId FROM Track GROUP BY GenreId ORDER BY COUNT(*) DESC LIMIT 1);,"Genre, Track","SELECT Genre.Name, COUNT(*) AS TrackCount FROM Genre JOIN Track ON Genre.GenreId = Track.GenreId GROUP BY Genre.GenreId ORDER BY TrackCount DESC LIMIT 1;","The most popular genre is Rock with 1,297 tracks.",Rock,"('Rock', 1297)"
What is the highest amount ever billed to a single customer for an invoice?,SELECT MAX(Total) FROM Invoice;,Invoice,"SELECT MAX(Total) AS HighestTotal, InvoiceId FROM Invoice GROUP BY CustomerId ORDER BY HighestTotal DESC LIMIT 1;",The highest invoice total is $25.86 for invoice ID 404.,25.86,"(25.86, 404)"
What is the name of the track that has generated the most revenue?,SELECT T.Name FROM Track T JOIN InvoiceLine IL ON T.TrackId = IL.TrackId GROUP BY T.TrackId ORDER BY SUM(IL.UnitPrice * IL.Quantity) DESC LIMIT 1;,"Track, InvoiceLine","SELECT Track.Name, SUM(InvoiceLine.UnitPrice * InvoiceLine.Quantity) AS TotalRevenue FROM Track JOIN InvoiceLine ON Track.TrackId = InvoiceLine.TrackId GROUP BY Track.TrackId ORDER BY TotalRevenue DESC LIMIT 1;",The track 'The Woman King' generated the most revenue at $3.98.,The Woman King,"('The Woman King', 3.98)"
Which customer has spent the most money in total?,SELECT FirstName|| ' ' ||LastName FROM Customer WHERE CustomerId = (SELECT CustomerId FROM Invoice GROUP BY CustomerId ORDER BY SUM(Total) DESC LIMIT 1);,"Customer, Invoice","SELECT Customer.FirstName || ' ' || Customer.LastName AS FullName, SUM(Total) AS TotalSpent FROM Customer JOIN Invoice ON Customer.CustomerId = Invoice.CustomerId GROUP BY Customer.CustomerId ORDER BY TotalSpent DESC LIMIT 1;","Helena Holý spent the most money, totaling approximately $49.62.",Helena Holý,"('Helena Holý', 49.620000000000005)"
Which artist's tracks are the most purchased?,SELECT A.Name FROM Artist A JOIN Album Al ON A.ArtistId = Al.ArtistId JOIN Track T ON Al.AlbumId = T.AlbumId JOIN InvoiceLine IL ON T.TrackId = IL.TrackId GROUP BY A.ArtistId ORDER BY COUNT(*) DESC LIMIT 1;,"Artist, Album, Track, InvoiceLine","SELECT Artist.Name, COUNT(*) AS TotalPurchases FROM Artist JOIN Album ON Artist.ArtistId = Album.ArtistId JOIN Track ON Album.AlbumId = Track.AlbumId JOIN InvoiceLine ON Track.TrackId = InvoiceLine.TrackId GROUP BY Artist.ArtistId ORDER BY TotalPurchases DESC LIMIT 1;",Iron Maiden's tracks were purchased 140 times.,Iron Maiden,"('Iron Maiden', 140)"
Which employee has generated the most revenue from their customers?,SELECT E.FirstName|| ' ' ||E.LastName FROM Employee E JOIN Customer C ON E.EmployeeId = C.SupportRepId JOIN Invoice I ON C.CustomerId = I.CustomerId GROUP BY E.EmployeeId ORDER BY SUM(I.Total) DESC LIMIT 1;,"Employee, Customer, Invoice","SELECT Customer.FirstName || ' ' || Customer.LastName AS FullName, SUM(Invoice.Total) AS TotalRevenue FROM Employee JOIN Customer ON Employee.EmployeeId = Customer.SupportRepId JOIN Invoice ON Customer.CustomerId = Invoice.CustomerId GROUP BY Employee.EmployeeId ORDER BY TotalRevenue DESC LIMIT 1;",Fynn Zimmermann generated the most revenue at $833.04.,Fynn Zimmermann,"('Fynn Zimmermann', 833.0400000000016)"
What is the name of the most popular playlist by number of tracks included?,SELECT P.Name FROM Playlist P JOIN PlaylistTrack PT ON P.PlaylistId = PT.PlaylistId GROUP BY P.PlaylistId ORDER BY COUNT(*) DESC LIMIT 1;,"Playlist, PlaylistTrack","SELECT Playlist.Name, COUNT(*) AS TrackCount FROM Playlist JOIN PlaylistTrack ON Playlist.PlaylistId = PlaylistTrack.PlaylistId GROUP BY Playlist.PlaylistId ORDER BY TrackCount DESC LIMIT 1;","The 'Music' playlist contains 3,290 tracks.",Music,"('Music', 3290)"
Which genre has generated the highest total revenue?,SELECT G.Name FROM Genre G JOIN Track T ON G.GenreId = T.GenreId JOIN InvoiceLine IL ON T.TrackId = IL.TrackId GROUP BY G.GenreId ORDER BY SUM(IL.UnitPrice * IL.Quantity) DESC LIMIT 1;,"Genre, Track, InvoiceLine","SELECT Genre.Name, SUM(InvoiceLine.UnitPrice * InvoiceLine.Quantity) AS TotalRevenue FROM Genre JOIN Track ON Genre.GenreId = Track.GenreId JOIN InvoiceLine ON Track.TrackId = InvoiceLine.TrackId GROUP BY Genre.GenreId ORDER BY TotalRevenue DESC LIMIT 1;",Rock generated the highest total revenue at approximately $826.65.,Rock,"('Rock', 826.6500000000061)"
What is the duration in minutes of the longest track recorded by the artist 'AC/DC'?,SELECT MAX(T.Milliseconds) / 60000 AS LongestTrackMinutes FROM Track T JOIN Album Al ON T.AlbumId = Al.AlbumId JOIN Artist A ON Al.ArtistId = A.ArtistId WHERE A.Name = 'AC/DC';,"Track, Album, Artist","SELECT Track.Name, MAX(Track.Milliseconds) / 60000 AS DurationMinutes FROM Track JOIN Album ON Track.AlbumId = Album.AlbumId JOIN Artist ON Album.ArtistId = Artist.ArtistId WHERE Artist.Name = 'AC/DC' GROUP BY Artist.ArtistId ORDER BY DurationMinutes DESC LIMIT 1;",The track 'Overdose' by AC/DC has a duration of 6 minutes.,6,"('Overdose', 6)"
Which employee's customers have the highest average invoice total?,SELECT E.FirstName|| ' ' || E.LastName FROM Employee E JOIN Customer C ON E.EmployeeId = C.SupportRepId JOIN Invoice I ON C.CustomerId = I.CustomerId GROUP BY E.EmployeeId ORDER BY AVG(I.Total) DESC LIMIT 1;,"Employee, Customer, Invoice","SELECT Employee.FirstName || ' ' || Employee.LastName AS FullName, AVG(Invoice.Total) AS AverageInvoiceTotal FROM Employee JOIN Customer ON Employee.EmployeeId = Customer.SupportRepId JOIN Invoice ON Customer.CustomerId = Invoice.CustomerId GROUP BY Employee.EmployeeId ORDER BY AverageInvoiceTotal DESC LIMIT 1;",Steve Johnson's customers have the highest average invoice total at approximately $5.72.,Steve Johnson,"('Steve Johnson', 5.715555555555564)"
Who is the customer that has purchased tracks from the highest number of different genres?,SELECT FirstName|| ' ' ||LastName FROM Customer WHERE CustomerId = ( SELECT C.CustomerId FROM Customer C JOIN Invoice I ON C.CustomerId = I.CustomerId JOIN InvoiceLine IL ON I.InvoiceId = IL.InvoiceId JOIN Track T ON IL.TrackId = T.TrackId JOIN Genre G ON T.GenreId = G.GenreId GROUP BY C.CustomerId ORDER BY COUNT(DISTINCT G.GenreId) DESC LIMIT 1 );,"Customer, Invoice, InvoiceLine, Track, Genre","SELECT Customer.FirstName || ' ' || Customer.LastName AS FullName, COUNT(DISTINCT Genre.GenreId) AS GenreCount FROM Customer JOIN Invoice ON Customer.CustomerId = Invoice.CustomerId JOIN InvoiceLine ON Invoice.InvoiceId = InvoiceLine.InvoiceId JOIN Track ON InvoiceLine.TrackId = Track.TrackId JOIN Genre ON Track.GenreId = Genre.GenreId GROUP BY Customer.CustomerId ORDER BY GenreCount DESC LIMIT 1;",Luis Rojas purchased tracks from 12 different genres.,Luis Rojas,"('Luis Rojas', 12)"
On which day of the week does the store earn the most revenue on average?,"SELECT strftime('%w', InvoiceDate) AS DayOfWeek, AVG(Total) AS AvgRevenue FROM Invoice GROUP BY DayOfWeek ORDER BY AvgRevenue DESC LIMIT 1;",Invoice,"SELECT strftime('%w', InvoiceDate) AS DayOfWeek, AVG(Total) AS AverageRevenue FROM Invoice GROUP BY DayOfWeek ORDER BY AverageRevenue DESC LIMIT 1;","Wednesday is the most lucrative day, averaging about $5.91 per invoice.",4,"('4', 5.911525423728816)"
Which track appears in the most playlists?,SELECT T.Name FROM Track T JOIN PlaylistTrack PT ON T.TrackId = PT.TrackId GROUP BY T.TrackId ORDER BY COUNT(*) DESC LIMIT 1;,"Track, PlaylistTrack","SELECT Track.Name, COUNT(*) AS PlaylistCount FROM Track JOIN PlaylistTrack ON Track.TrackId = PlaylistTrack.TrackId GROUP BY Track.TrackId ORDER BY PlaylistCount DESC LIMIT 1;",The track 'Intoitus: Adorate Deum' appears in 5 playlists.,Intoitus: Adorate Deum,"('Intoitus: Adorate Deum', 5)"
Which composer's tracks have generated the most revenue?,SELECT Composer FROM Track JOIN InvoiceLine ON Track.TrackId = InvoiceLine.TrackId WHERE Composer IS NOT NULL GROUP BY Composer ORDER BY SUM(InvoiceLine.UnitPrice * InvoiceLine.Quantity) DESC LIMIT 1;,"Track, InvoiceLine","SELECT Composer, SUM(InvoiceLine.UnitPrice * InvoiceLine.Quantity) AS TotalRevenue FROM Track JOIN InvoiceLine ON Track.TrackId = InvoiceLine.TrackId WHERE Composer IS NOT NULL GROUP BY Composer ORDER BY TotalRevenue DESC LIMIT 1;",Tracks composed by Steve Harris generated revenue totaling $57.42.,Steve Harris,"('Steve Harris', 57.42000000000003)"
